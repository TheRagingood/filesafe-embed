module.exports=function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=13)}([function(e,t){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}e.exports=n},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e}e.exports=a},function(e,t){e.exports=require("react")},function(e,t,n){function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}var r=n(15),i=n(7);e.exports=a},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}var r=n(16);e.exports=a},function(e,t,n){"use strict";n.d(t,"a",function(){return c});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(8),l=n.n(o),c=function(){function e(){r()(this,e),this.unloadHandlers=[],this.dataChangeObservers=[]}return s()(e,null,[{key:"get",value:function(){return null==this.instance&&(this.instance=new e),this.instance}}]),s()(e,[{key:"setFilesafeInstance",value:function(e){var t=this;this.filesafe=e,this.fsObserver=e.addDataChangeObserver(function(){var e=!0,n=!1,a=void 0;try{for(var r,i=t.dataChangeObservers[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){(0,r.value)()}}catch(e){n=!0,a=e}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}})}},{key:"setDelegate",value:function(e){this.delegate=e}},{key:"getDelegate",value:function(){return this.delegate||{}}},{key:"addDataChangeObserver",value:function(e){this.dataChangeObservers.push(e)}},{key:"addUnloadHandler",value:function(e){this.unloadHandlers.push(e)}},{key:"unload",value:function(){var t=!0,n=!1,a=void 0;try{for(var r,i=this.unloadHandlers[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){(0,r.value)()}}catch(e){n=!0,a=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw a}}this.dataChangeObservers=[],this.filesafe&&this.filesafe.removeDataChangeObserver(this.fsObserver),e.instance=null}},{key:"defaultRelayServerUrl",value:function(){return window.default_fs_relay_server_url||"https://filesafe.standardnotes.org"}}]),e}();l()(c,"instance",null)},function(e,t){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}e.exports=n},function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}e.exports=n},function(e,t,n){e.exports=n(20)},function(e,t){function n(e,t,n,a,r,i,s){try{var o=e[i](s),l=o.value}catch(e){return void n(e)}o.done?t(l):Promise.resolve(l).then(a,r)}function a(e){return function(){var t=this,a=arguments;return new Promise(function(r,i){function s(e){n(l,r,i,s,o,"next",e)}function o(e){n(l,r,i,s,o,"throw",e)}var l=e.apply(t,a);s(void 0)})}}e.exports=a},function(e,t){e.exports=require("react-dom")},function(e,t,n){"use strict";n.d(t,"a",function(){return N});var a=n(9),r=n.n(a),i=n(10),s=n.n(i),o=n(0),l=n.n(o),c=n(1),u=n.n(c),f=n(3),d=n.n(f),p=n(4),h=n.n(p),m=n(7),v=n.n(m),g=n(5),y=n.n(g),w=n(8),b=n.n(w),k=n(2),E=n.n(k),F=n(6),N=function(e){function t(e){var n;return l()(this,t),n=d()(this,h()(t).call(this,e)),b()(v()(n),"setStatusForFile",function(e,t,a){n.setState({fileStatusFile:e,fileStatus:t,hasStatusSpinner:a})}),b()(v()(n),"decryptFile",function(){var e=s()(r.a.mark(function e(t){var a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=F.a.get().filesafe.integrationForFileDescriptor(t)){e.next=4;break}return alert("Unable to find integration for file. If you have deleted the integration, please re-add it and try again."),e.abrupt("return");case 4:return i=F.a.get().filesafe.displayStringForIntegration(a),n.setStatusForFile(t,"Downloading from ".concat(i,"..."),!0),e.abrupt("return",F.a.get().filesafe.downloadFileFromDescriptor(t).then(function(e){return n.setStatusForFile(t,"Decrypting...",!0),F.a.get().filesafe.decryptFile({fileDescriptor:t,fileItem:e}).then(function(e){return{base64Data:e.decryptedData,fileName:t.content.fileName,fileType:t.content.fileType}}).catch(function(e){console.error("filesafe-embed | error decrypting file:",e),n.flashError("Error decrypting file.")})}).catch(function(e){console.log("Error downloading file",e),n.flashError("Error downloading file.")}));case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),b()(v()(n),"downloadFile",function(){var e=s()(r.a.mark(function e(t){var a,i,s;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isMobile){e.next=5;break}return a=F.a.get().filesafe.getPlatform(),i="ios"==a?"iOS":"Android",alert("Downloading files is not currently supported on ".concat(i,".")),e.abrupt("return");case 5:return e.next=7,n.decryptFile(t);case 7:s=e.sent,F.a.get().filesafe.downloadBase64Data(s),n.setStatusForFile(t,null);case 10:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),b()(v()(n),"previewFile",function(){var e=s()(r.a.mark(function e(t){var a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.decryptFile(t);case 2:a=e.sent,i=F.a.get().filesafe.createTemporaryFileUrl({base64Data:a.base64Data,dataType:a.fileType}),n.setStatusForFile(t,null),n.setState({previewUrl:i,previewingFile:t});case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()),b()(v()(n),"onClickPreview",function(){setTimeout(function(){n.revokePreview()},500)}),b()(v()(n),"selectFile",function(e,t){e.target.focus(),n.state.selectedFile==t?(n.setState({selectedFile:null}),n.delegate.onSelectFile&&n.delegate.onSelectFile(null)):(n.setState({selectedFile:t}),n.delegate.onSelectFile&&n.delegate.onSelectFile(t)),n.revokePreview()}),b()(v()(n),"deleteFile",function(e){F.a.get().filesafe.deleteFileFromDescriptor(e)}),b()(v()(n),"copyInsertionLink",function(e){var t="[FileSafe:".concat(e.uuid,":").concat(e.content.fileName,"]");F.a.get().filesafe.copyTextToClipboard(t),n.setState({copiedLink:e}),setTimeout(function(){n.setState({copiedLink:null})},1e3)}),b()(v()(n),"isFileSelected",function(e){return n.state.selectedFile==e}),b()(v()(n),"elementForFile",function(e){var t,a=F.a.get().filesafe.integrationForFileDescriptor(e);t=a?F.a.get().filesafe.displayStringForIntegration(a):"Integration Not Found";var r=e.content.serverMetadata.file_path,i=n.state.previewUrl&&n.state.previewingFile==e,s=n.state.fileStatusFile==e&&n.state.fileStatus,o=n.state.hasStatusSpinner;return E.a.createElement("div",{className:"file-item-container "+(n.isFileSelected(e)?"expanded":"")},E.a.createElement("div",{onClick:function(t){n.selectFile(t,e)},className:"file-item-button sk-button info "+(n.isFileSelected(e)?"selected":void 0)},E.a.createElement("div",{className:"sk-label"},e.content.fileName),s&&E.a.createElement("div",{className:"file-download-status sk-horizontal-group"},o&&E.a.createElement("div",{className:"sk-spinner x-small"}),E.a.createElement("div",{className:"file-status-label"},n.state.fileStatus)),n.isFileSelected(e)&&E.a.createElement("div",{className:"file-item-options-wrapper"},E.a.createElement("div",{onClick:function(e){e.stopPropagation()},className:"sk-app-bar file-item-options"},E.a.createElement("div",{className:"center"},E.a.createElement("div",{onClick:function(t){t.stopPropagation(),n.downloadFile(e)},className:"sk-app-bar-item"},E.a.createElement("div",{className:"sk-label contrast "+(n.isMobile?"disabled":"")},"Download")),E.a.createElement("div",{className:"sk-app-bar-item border"}),n.supportsPreviews&&i&&E.a.createElement("a",{className:"sk-app-bar-item",href:n.state.previewUrl,onClick:function(e){e.stopPropagation(),n.onClickPreview()},target:"_blank"},E.a.createElement("div",{className:"sk-label contrast"},"Open Preview")),n.supportsPreviews&&!i&&E.a.createElement("div",{onClick:function(t){t.stopPropagation(),n.previewFile(e)},className:"sk-app-bar-item"},E.a.createElement("div",{className:"sk-label contrast "+(n.isMobile?"disabled":"")},"Preview")),n.supportsPreviews&&E.a.createElement("div",{className:"sk-app-bar-item border"}),E.a.createElement("div",{onClick:function(t){t.stopPropagation(),n.copyInsertionLink(e)},className:"sk-app-bar-item"},E.a.createElement("div",{className:"sk-label contrast"},n.state.copiedLink==e?"Copied":"Copy Insert Link")),E.a.createElement("div",{className:"sk-app-bar-item border"}),E.a.createElement("div",{onClick:function(t){t.stopPropagation(),n.deleteFile(e)},className:"sk-app-bar-item"},E.a.createElement("div",{className:"sk-label contrast"},"Delete")))),E.a.createElement("div",{className:"file-location"},E.a.createElement("strong",null,t),E.a.createElement("span",null," ",r)))))}),n.state={},n.delegate=F.a.get().getDelegate(),n}return y()(t,e),u()(t,[{key:"revokePreview",value:function(){this.state.previewUrl&&F.a.get().filesafe.revokeTempUrl(this.state.previewUrl),this.setState({previewUrl:null,previewingFile:null})}},{key:"flashError",value:function(e){var t=this;this.setStatusForFile(e,!1),setTimeout(function(){t.setStatusForFile(null)},2500)}},{key:"render",value:function(){var e=this;return this.props.files.map(function(t){return e.elementForFile(t)})}},{key:"supportsPreviews",get:function(){if(void 0!==this._supportsPreview)return this._supportsPreview;var e=F.a.get().filesafe.getEnvironment();if(void 0==e)return!1;this._supportsPreview="web"==e}},{key:"isMobile",get:function(){return F.a.get().filesafe.isMobile()}}]),t}(E.a.Component)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r=n.n(a),i=n(11),s=n.n(i),o=n(14);t.default={FilesafeEmbed:o.a,React:r.a,ReactDOM:s.a}},function(e,t,n){"use strict";n.d(t,"a",function(){return w});var a=n(0),r=n.n(a),i=n(3),s=n.n(i),o=n(4),l=n.n(o),c=n(1),u=n.n(c),f=n(5),d=n.n(f),p=n(2),h=n.n(p),m=n(11),v=n.n(m),g=n(17),y=n(6),w=function(e){function t(e){return r()(this,t),s()(this,l()(t).call(this,e))}return d()(t,e),u()(t,null,[{key:"renderInElement",value:function(e,n,a){y.a.get().setFilesafeInstance(n),y.a.get().setDelegate(a),v.a.render(h.a.createElement(t),e)}},{key:"unload",value:function(e){y.a.get().unload(),v.a.unmountComponentAtNode(e)}}]),u()(t,[{key:"render",value:function(){return h.a.createElement("div",{id:"filesafe-embed"},h.a.createElement("div",{className:"sn-component"},h.a.createElement(g.a,null)))}}]),t}(h.a.Component)},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=a=function(e){return n(e)}:e.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(t)}e.exports=a},function(e,t){function n(t,a){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,a)}e.exports=n},function(e,t,n){"use strict";n.d(t,"a",function(){return w});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(3),l=n.n(o),c=n(4),u=n.n(c),f=n(5),d=n.n(f),p=n(2),h=n.n(p),m=n(18),v=n(19),g=n(23),y=n(24),w=(n(6),function(e){function t(e){var n;return r()(this,t),n=l()(this,u()(t).call(this,e)),n.state={messages:[]},n}return d()(t,e),s()(t,[{key:"render",value:function(){return h.a.createElement("div",{id:"home",className:"sk-panel static"},h.a.createElement("div",{id:"main-content",className:"sk-panel-content"},h.a.createElement("div",{className:"sk-panel-section"},h.a.createElement(v.a,null)),h.a.createElement("div",{className:"sk-panel-section"},h.a.createElement(y.a,null)),h.a.createElement("div",{className:"sk-panel-section"},h.a.createElement(m.a,null)),h.a.createElement("div",{className:"sk-panel-section"},h.a.createElement(g.a,null))))}}]),t}(h.a.Component))},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(3),l=n.n(o),c=n(4),u=n.n(c),f=n(7),d=n.n(f),p=n(5),h=n.n(p),m=n(8),v=n.n(m),g=n(2),y=n.n(g),w=n(6),b=function(e){function t(e){var n;return r()(this,t),n=l()(this,u()(t).call(this,e)),v()(d()(n),"exportCredential",function(e){var t=btoa(JSON.stringify(e,null,2));w.a.get().filesafe.downloadBase64Data({base64Data:t,fileName:"sn-filesafe-keys-".concat(e.created_at.toISOString(),".json"),fileType:"text/json"})}),v()(d()(n),"deleteCredential",function(e){if(0!=n.numFilesForCredential(e))return void alert("This key has files encrypted with it and cannot be deleted. First delete any associated files, then try again.");w.a.get().filesafe.deleteCredential(e)}),v()(d()(n),"createNewKeys",function(){w.a.get().filesafe.createNewCredentials()}),v()(d()(n),"labelForCredential",function(e){return e.created_at.toLocaleString()}),v()(d()(n),"numFilesForCredential",function(e){return w.a.get().filesafe.numberOfFilesEncryptedWithCredential(e)}),v()(d()(n),"setCredentialAsDefault",function(e){w.a.get().filesafe.setCredentialAsDefault(e)}),n.state={credentials:w.a.get().filesafe.getAllCredentials()||[]},w.a.get().addDataChangeObserver(function(){n.setState({credentials:w.a.get().filesafe.getAllCredentials()})}),n}return h()(t,e),s()(t,[{key:"render",value:function(){var e=this;return y.a.createElement("div",null,y.a.createElement("div",{className:"sk-panel-row"},y.a.createElement("div",{className:"sk-h2 sk-bold"},"Keys"),y.a.createElement("div",{className:"sk-button info no-border",onClick:this.createNewKeys},y.a.createElement("div",{className:"sk-label"},"Create New"))),y.a.createElement("div",{className:"list-container"},this.state.credentials.map(function(t){return y.a.createElement("div",{className:"list-item sk-horizontal-group top"},y.a.createElement("div",{className:"sk-circle x-small "+(t.content.isDefault?"info":"sk-secondary-contrast")}),y.a.createElement("div",null,y.a.createElement("div",{className:"sk-panel-row condensed sk-bold"},e.labelForCredential(t)),y.a.createElement("div",{style:{marginTop:3},className:"sk-panel-row condensed"},e.numFilesForCredential(t)," encrypted files"),y.a.createElement("div",{className:"sk-panel-row condensed"},y.a.createElement("div",{className:"sk-horizontal-group"},e.state.credentials.length>1&&!t.content.isDefault&&y.a.createElement("a",{className:"info",onClick:function(){e.setCredentialAsDefault(t)}},"Make Default"),y.a.createElement("a",{className:"info",onClick:function(){e.exportCredential(t)}},"Export"),y.a.createElement("a",{className:"danger",onClick:function(){e.deleteCredential(t)}},"Delete")))))})))}}]),t}(y.a.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return C});var a=n(9),r=n.n(a),i=n(10),s=n.n(i),o=n(0),l=n.n(o),c=n(1),u=n.n(c),f=n(3),d=n.n(f),p=n(4),h=n.n(p),m=n(7),v=n.n(m),g=n(5),y=n.n(g),w=n(8),b=n.n(w),k=n(2),E=n.n(k),F=n(21),N=n(22),x=n(12),S=n(6),C=function(e){function t(e){var n;return l()(this,t),n=d()(this,h()(t).call(this,e)),b()(v()(n),"event_preventDefaults",function(e){e.preventDefault(),e.stopPropagation()}),b()(v()(n),"event_highlight",function(e){n.event_preventDefaults(e),n.rootElement.classList.add("highlight")}),b()(v()(n),"event_unhighlight",function(e){n.event_preventDefaults(e),n.rootElement.classList.remove("highlight")}),b()(v()(n),"event_drop",function(e){n.event_unhighlight(e),n.event_preventDefaults(e);var t=e.dataTransfer,a=t.files;n.handleDroppedFiles(a)}),b()(v()(n),"handleDroppedFiles",function(){var e=s()(r.a.mark(function e(t){var a,i,s,o,l,c;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!=S.a.get().filesafe.getAllIntegrations().length){e.next=3;break}return alert("Please set up at least one integration before attempting to upload a file. To do this, press Expand, and select Add New in the Integrations section."),e.abrupt("return");case 3:a=!0,i=!1,s=void 0,e.prev=6,o=t[Symbol.iterator]();case 8:if(a=(l=o.next()).done){e.next=17;break}if(c=l.value){e.next=12;break}return e.abrupt("continue",14);case 12:return e.next=14,n.readFile(c);case 14:a=!0,e.next=8;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(6),i=!0,s=e.t0;case 23:e.prev=23,e.prev=24,a||null==o.return||o.return();case 26:if(e.prev=26,!i){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(23);case 31:setTimeout(function(){n.setState({status:null})},2e3);case 32:case"end":return e.stop()}},e,null,[[6,19,23,31],[24,,26,30]])}));return function(t){return e.apply(this,arguments)}}()),n.messagesManager=new F.a({credentialManager:S.a.get().filesafe.credentialManager,integrationManager:S.a.get().filesafe.integrationManager}),n.messagesManager.getMessages().then(function(e){n.setState({messages:e})}),n.state={noteFiles:S.a.get().filesafe.fileDescriptorsForCurrentNote(),messages:[]},S.a.get().addDataChangeObserver(function(){n.reload()}),S.a.get().addUnloadHandler(function(){window.removeEventListener("dragenter",n.event_highlight,!1),window.removeEventListener("dragover",n.event_highlight,!1),window.removeEventListener("dragleave",n.event_unhighlight,!1),window.removeEventListener("drop",n.event_drop,!1)}),n}return y()(t,e),u()(t,[{key:"reload",value:function(){function e(){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(){var t;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.messagesManager.getMessages();case 2:t=e.sent,this.setState({noteFiles:S.a.get().filesafe.fileDescriptorsForCurrentNote(),messages:t});case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"componentDidMount",value:function(){this.configureFileForm(),window.addEventListener("dragenter",this.event_highlight,!1),window.addEventListener("dragover",this.event_highlight,!1),window.addEventListener("dragleave",this.event_unhighlight,!1),window.addEventListener("drop",this.event_drop,!1)}},{key:"configureFileForm",value:function(){var e=this,t=this.fileInput;this.dropContainer;t&&(t.onchange=function(t){var n=t.target.files;e.handledFiles||e.handleDroppedFiles(n)})}},{key:"reset",value:function(){this.setState({rawData:null,decryptedItems:null,requestPassword:!1})}},{key:"readFile",value:function(){function e(e){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(t){var n,a,i,o=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=50,a=1e6,i=n*a,e.abrupt("return",new Promise(function(e,a){var l=new FileReader,c=!1;l.onload=function(){var a=s()(r.a.mark(function a(s){var l,u,f,d,p;return r.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(l=s.target.result,!c){a.next=7;break}l=JSON.parse(l),u=l.items[0],o.decryptDraggedFile(u).then(e),a.next=20;break;case 7:if(f=l,!((d=f.byteLength)>i)){a.next=14;break}return alert("The maximum upload size is ".concat(n," megabytes per file.")),o.setState({status:null}),e(),a.abrupt("return");case 14:return a.next=16,SFJS.crypto.arrayBufferToBase64(f);case 16:return p=a.sent,a.next=19,o.encryptFile(p,t.name,t.type);case 19:e();case 20:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}(),o.setState({status:"Reading file..."}),t.name.endsWith(".sf")||t.name.endsWith(".json")?(c=!0,l.readAsText(t)):l.readAsArrayBuffer(t)}));case 4:case"end":return e.stop()}},e)}));return e}()},{key:"decryptDraggedFile",value:function(){function e(e){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(t){var n,a,i,o,l,c,u,f,d,p=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({status:"Decrypting..."}),n=S.a.get().filesafe.getAllCredentials(),a=function(){var e=s()(r.a.mark(function e(n){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,a){S.a.get().filesafe.decryptFile({fileDescriptor:t,credential:n}).then(function(t){var n=t.decryptedItem;S.a.get().filesafe.downloadBase64Data({base64Data:t.decryptedData,fileName:n.content.fileName,fileType:n.content.fileType}),p.setState({status:null}),e(!0)}).catch(function(e){console.error("Error decrypting:",e),p.flashError("Error decrypting file."),a(!1)})}));case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),i=!0,o=!1,l=void 0,e.prev=6,c=n[Symbol.iterator]();case 8:if(i=(u=c.next()).done){e.next=18;break}return f=u.value,e.next=12,a(f);case 12:if(!(d=e.sent)){e.next=15;break}return e.abrupt("return");case 15:i=!0,e.next=8;break;case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(6),o=!0,l=e.t0;case 24:e.prev=24,e.prev=25,i||null==c.return||c.return();case 27:if(e.prev=27,!o){e.next=30;break}throw l;case 30:return e.finish(27);case 31:return e.finish(24);case 32:case"end":return e.stop()}},e,this,[[6,20,24,32],[25,,27,31]])}));return e}()},{key:"wait",value:function(){function e(e){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,n){setTimeout(function(){e()},1e3*t)}));case 1:case"end":return e.stop()}},e)}));return e}()},{key:"encryptFile",value:function(){function e(e,n,a){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(t,n,a){var i,o,l=this;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({status:"Encrypting..."}),i=S.a.get().filesafe.getDefaultCredentials(),o=S.a.get().filesafe.getDefaultIntegration(),e.abrupt("return",S.a.get().filesafe.encryptFile({data:t,inputFileName:n,fileType:a,credential:i}).then(function(){var e=s()(r.a.mark(function e(t){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l.setState({status:"Uploading to ".concat(S.a.get().filesafe.displayStringForIntegration(o),"...")}),e.next=3,l.wait(.5);case 3:return e.abrupt("return",S.a.get().filesafe.uploadFile({fileItem:t,inputFileName:n,fileType:a,credential:i}).then(function(){l.setState({status:"Upload Success."})}).catch(function(e){console.error("fs-embed | error uploading file:",e),l.flashError("Error uploading file.")}));case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"flashError",value:function(e){var t=this;this.setState({status:e,statusClass:"danger"}),setTimeout(function(){t.setState({status:null,statusClass:null})},2500)}},{key:"render",value:function(){var e=this,t=this.state.statusClass?this.state.statusClass:"info",n="info"==t;return E.a.createElement("div",{className:"sn-component files-view"},E.a.createElement("div",{className:"sk-panel-row align-top"},E.a.createElement("div",{className:"files"},this.state.messages.length>0&&E.a.createElement("div",{id:"messages-container",className:"sk-panel-section"},E.a.createElement(N.a,{messages:this.state.messages})),this.state.status&&E.a.createElement("div",{id:"file-upload-status",className:"sk-horizontal-group"},n&&E.a.createElement("div",{className:"sk-spinner info small"}),E.a.createElement("div",{className:t},this.state.status)),E.a.createElement("div",{id:"add-file-button-container"},E.a.createElement("div",{className:"file sk-button info"},E.a.createElement("label",{className:"no-style"},E.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(t){e.handleDroppedFiles(t.target.files)}}),E.a.createElement("div",{id:"attach-file-button-label",className:"sk-label"},"Attach File")))),E.a.createElement(x.a,{files:this.state.noteFiles}))))}},{key:"rootElement",get:function(){return document.getElementById("filesafe-embed")}},{key:"dropContainer",get:function(){return document.getElementById("files-view")}},{key:"fileInput",get:function(){return document.getElementById("file-input")}}]),t}(E.a.Component)},function(e,t,n){var a=function(e){"use strict";function t(e,t,n,r){var i=t&&t.prototype instanceof a?t:a,s=Object.create(i.prototype),o=new d(r||[]);return s._invoke=l(e,n,o),s}function n(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function a(){}function r(){}function i(){}function s(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function o(e){function t(a,r,i,s){var o=n(e[a],e,r);if("throw"!==o.type){var l=o.arg,c=l.value;return c&&"object"==typeof c&&g.call(c,"__await")?Promise.resolve(c.__await).then(function(e){t("next",e,i,s)},function(e){t("throw",e,i,s)}):Promise.resolve(c).then(function(e){l.value=e,i(l)},function(e){return t("throw",e,i,s)})}s(o.arg)}function a(e,n){function a(){return new Promise(function(a,r){t(e,n,a,r)})}return r=r?r.then(a,a):a()}var r;this._invoke=a}function l(e,t,a){var r=E;return function(i,s){if(r===N)throw new Error("Generator is already running");if(r===x){if("throw"===i)throw s;return h()}for(a.method=i,a.arg=s;;){var o=a.delegate;if(o){var l=c(o,a);if(l){if(l===S)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===E)throw r=x,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=N;var u=n(e,t,a);if("normal"===u.type){if(r=a.done?x:F,u.arg===S)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(r=x,a.method="throw",a.arg=u.arg)}}}function c(e,t){var a=e.iterator[t.method];if(a===m){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=m,c(e,t),"throw"===t.method))return S;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return S}var r=n(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,S;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=m),t.delegate=null,S):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,S)}function u(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function d(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(u,this),this.reset(!0)}function p(e){if(e){var t=e[w];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(g.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=m,t.done=!0,t};return a.next=a}}return{next:h}}function h(){return{value:m,done:!0}}var m,v=Object.prototype,g=v.hasOwnProperty,y="function"==typeof Symbol?Symbol:{},w=y.iterator||"@@iterator",b=y.asyncIterator||"@@asyncIterator",k=y.toStringTag||"@@toStringTag";e.wrap=t;var E="suspendedStart",F="suspendedYield",N="executing",x="completed",S={},C={};C[w]=function(){return this};var D=Object.getPrototypeOf,I=D&&D(D(p([])));I&&I!==v&&g.call(I,w)&&(C=I);var _=i.prototype=a.prototype=Object.create(C);return r.prototype=_.constructor=i,i.constructor=r,i[k]=r.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===r||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,i):(e.__proto__=i,k in e||(e[k]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},s(o.prototype),o.prototype[b]=function(){return this},e.AsyncIterator=o,e.async=function(n,a,r,i){var s=new o(t(n,a,r,i));return e.isGeneratorFunction(a)?s:s.next().then(function(e){return e.done?e.value:s.next()})},s(_),_[k]="Generator",_[w]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=p,d.prototype={constructor:d,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=m,this.done=!1,this.delegate=null,this.method="next",this.arg=m,this.tryEntries.forEach(f),!e)for(var t in this)"t"===t.charAt(0)&&g.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=m)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){function t(t,a){return i.type="throw",i.arg=e,n.next=t,a&&(n.method="next",n.arg=m),!!a}if(this.done)throw e;for(var n=this,a=this.tryEntries.length-1;a>=0;--a){var r=this.tryEntries[a],i=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var s=g.call(r,"catchLoc"),o=g.call(r,"finallyLoc");if(s&&o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(s){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!o)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&g.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var r=a;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,S):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),S},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),f(n),S}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;f(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:p(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=m),S}},e}(e.exports);try{regeneratorRuntime=a}catch(e){Function("r","regeneratorRuntime = r")(a)}},function(e,t,n){"use strict";n.d(t,"a",function(){return f});var a=n(9),r=n.n(a),i=n(10),s=n.n(i),o=n(0),l=n.n(o),c=n(1),u=n.n(c),f=function(){function e(t){var n=t.credentialManager,a=t.integrationManager;l()(this,e),this.credentialManager=n,this.integrationManager=a}return u()(e,[{key:"getMessages",value:function(){function e(){return t.apply(this,arguments)}var t=s()(r.a.mark(function e(){var t,n,a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.credentialManager.getDefaultCredentials();case 3:return n=e.sent,n||t.push({message:"Create keys by selecting <strong>Create New</strong> under <i>Keys</i>.",css:"sk-base"}),a=this.integrationManager.integrations,a&&0!=a.length||t.push({message:"Add a new integration by selecting <strong>Add New</strong> under <i>Integrations</i>",css:"sk-base"}),e.abrupt("return",t);case 8:case"end":return e.stop()}},e,this)}));return e}()}]),e}()},function(e,t,n){"use strict";n.d(t,"a",function(){return m});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(3),l=n.n(o),c=n(4),u=n.n(c),f=n(5),d=n.n(f),p=n(2),h=n.n(p),m=function(e){function t(e){var n;return r()(this,t),n=l()(this,u()(t).call(this,e)),n.state={},n}return d()(t,e),s()(t,[{key:"render",value:function(){return h.a.createElement("div",{id:"messages"},h.a.createElement("div",{className:"title"},"Complete the following steps before uploading your first file:"),h.a.createElement("ul",null,this.props.messages.map(function(e){return h.a.createElement("li",{dangerouslySetInnerHTML:{__html:e.message},className:e.css})})))}}]),t}(h.a.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return k});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(3),l=n.n(o),c=n(4),u=n.n(c),f=n(7),d=n.n(f),p=n(5),h=n.n(p),m=n(8),v=n.n(m),g=n(2),y=n.n(g),w=n(12),b=n(6),k=function(e){function t(e){var n;return r()(this,t),n=l()(this,u()(t).call(this,e)),v()(d()(n),"toggleVisibility",function(){n.setState({expanded:!n.state.expanded})}),n.state={expanded:!1,files:b.a.get().filesafe.getAllFileDescriptors()||[]},b.a.get().addDataChangeObserver(function(){n.setState({files:b.a.get().filesafe.getAllFileDescriptors()})}),n}return h()(t,e),s()(t,[{key:"render",value:function(){return y.a.createElement("div",{className:"files-view"},y.a.createElement("div",{className:"sk-panel-row justify-left"},y.a.createElement("div",{className:"sk-horizontal-group"},y.a.createElement("div",{className:"sk-panel-section-title"},"All Files ",y.a.createElement("span",{style:{fontWeight:"normal"}},"(",this.state.files.length,")")),y.a.createElement("a",{className:"info",onClick:this.toggleVisibility},this.state.expanded?"Hide":"Show"))),this.state.expanded&&y.a.createElement("div",{className:"sk-panel-row"},y.a.createElement("div",{className:"files"},y.a.createElement(w.a,{files:this.state.files}))))}}]),t}(y.a.Component)},function(e,t,n){"use strict";n.d(t,"a",function(){return b});var a=n(0),r=n.n(a),i=n(1),s=n.n(i),o=n(3),l=n.n(o),c=n(4),u=n.n(c),f=n(7),d=n.n(f),p=n(5),h=n.n(p),m=n(8),v=n.n(m),g=n(2),y=n.n(g),w=n(6),b=function(e){function t(e){var n;return r()(this,t),n=l()(this,u()(t).call(this,e)),v()(d()(n),"handleKeyPress",function(e){"Enter"===e.key&&n.submitIntegrationCode()}),v()(d()(n),"handleTextChange",function(e){var t=e.target.value;n.setState({integrationCode:t})}),v()(d()(n),"submitIntegrationCode",function(){var e=n.state.integrationCode;e&&0!=e.length&&w.a.get().filesafe.saveIntegrationFromCode(e).then(function(){n.setState({integrationCode:null,showInputForm:!1}),n.reloadIntegrations()}).catch(function(){alert("Invalid integration code. Ensure the correct value is copied and try again.")})}),v()(d()(n),"addNewIntegrationClicked",function(){window.open(w.a.get().defaultRelayServerUrl(),"_blank"),n.setState({showInputForm:!0})}),v()(d()(n),"cancelIntegrationForm",function(){n.setState({showInputForm:!1})}),v()(d()(n),"deleteIntegration",function(e){w.a.get().filesafe.deleteIntegration(e)}),v()(d()(n),"setIntegrationAsDefaultUploadSource",function(e){w.a.get().filesafe.setIntegrationAsDefault(e)}),n.state={integrations:w.a.get().filesafe.getAllIntegrations()||[]},w.a.get().addDataChangeObserver(function(){n.reloadIntegrations()}),n}return h()(t,e),s()(t,[{key:"reloadIntegrations",value:function(){var e=w.a.get().filesafe.getAllIntegrations();this.setState({integrations:e})}},{key:"componentDidMount",value:function(){}},{key:"componentWillUnmount",value:function(){}},{key:"displayStringForIntegration",value:function(e){return w.a.get().filesafe.displayStringForIntegration(e)}},{key:"render",value:function(){var e=this,t=this.state.integrations.length>1;return y.a.createElement("div",null,y.a.createElement("div",{className:"sk-panel-row"},y.a.createElement("div",{className:"sk-h2 sk-bold"},"Integrations"),!this.state.showInputForm&&y.a.createElement("div",{className:"sk-button info no-border",onClick:this.addNewIntegrationClicked},y.a.createElement("div",{className:"sk-label"},"Add New"))),y.a.createElement("div",{id:"integrations"},this.state.showInputForm&&y.a.createElement("div",{className:"sk-notification info"},y.a.createElement("strong",null,"New Integration"),y.a.createElement("p",{className:"sk-p"},"A new tab has opened. After you complete the authentication flow, enter the code you receive below."),y.a.createElement("div",{className:"sk-panel-row"}),y.a.createElement("input",{className:"title sk-input contrast",type:"text",placeholder:"Enter integration code",value:this.state.integrationCode,onChange:this.handleTextChange,onKeyPress:this.handleKeyPress}),y.a.createElement("div",{className:"sk-button-group",style:{marginTop:10}},y.a.createElement("div",{className:"sk-button neutral",onClick:this.cancelIntegrationForm},y.a.createElement("a",{className:"sk-label"},"Cancel")),y.a.createElement("div",{className:"sk-button sk-base",onClick:this.submitIntegrationCode},y.a.createElement("a",{className:"sk-label"},"Submit"))))),y.a.createElement("div",{className:"list-container"},this.state.integrations.map(function(n){return y.a.createElement("div",{className:"list-item sk-horizontal-group top"},y.a.createElement("div",{className:"sk-circle x-small "+(n.content.isDefaultUploadSource?"info":"sk-secondary-contrast")}),y.a.createElement("div",null,y.a.createElement("div",{className:"sk-panel-row condensed sk-bold"},e.displayStringForIntegration(n)),y.a.createElement("div",{className:"sk-panel-row condensed"},y.a.createElement("div",{className:"sk-horizontal-group"},t&&!n.content.isDefaultUploadSource&&y.a.createElement("a",{className:"info",onClick:function(){e.setIntegrationAsDefaultUploadSource(n)}},"Make Default"),y.a.createElement("a",{className:"danger",onClick:function(){e.deleteIntegration(n)}},"Delete")))))})))}}]),t}(y.a.Component)}]);